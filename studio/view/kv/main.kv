#:import asynckivy kivymd.utils.asynckivy

<ScreenMain>:
    md_bg_color: "#262626"

    MDBoxLayout:
        orientation: "vertical"
        
        MDBoxLayout:
            orientation: "horizontal"
            spacing: "2dp"
            padding: "5dp"

            MDBoxLayout:
                id: menu
                orientation: "vertical"
                md_bg_color: "#484848"
                spacing: "10dp"
                size_hint_x: .15

                MDBoxLayout:
                    id: menu
                    orientation: "vertical"
                    md_bg_color: "#484848"
                    spacing: "10dp"
                    size_hint_x: None
                    width: dp(40)
                    pos_hint: {'center_x': .5, 'center_y': .5}

                    IconButtonAction:

                        icon: "home"
                        icon_size: dp(20)
                        icon_color: "#4287f5"
                        theme_icon_color: "Custom"
                        unfocus_color: "#484848"
                        on_release:
                            root.callWelcome()
                    
                    IconButtonAction:
                        icon: "plus-outline"
                        icon_size: dp(20)
                        icon_color: "#4287f5"
                        theme_icon_color: "Custom"
                        unfocus_color: "#484848"
                        on_release:
                            app.open_cam()
                    
                    IconButtonAction:
                        icon: "web"
                        icon_size: dp(20)
                        icon_color: "#4287f5"
                        theme_icon_color: "Custom"
                        unfocus_color: "#484848"
                        on_release:
                            app.start_connexion()
                    
                    IconButtonAction:
                        icon: "cog-outline"
                        icon_size: dp(20)
                        icon_color: "#4287f5"
                        theme_icon_color: "Custom"
                        unfocus_color: "#484848"
                        on_release:
                            app.open_param()
                    
                    IconButtonAction:
                        icon: "account-outline"
                        icon_size: dp(20)
                        icon_color: "#4287f5"
                        theme_icon_color: "Custom"
                        unfocus_color: "#484848"
                        on_release:
                            app.data.compte()
                
                MDWidget:
                    size_hint_y: .4

            MDBoxLayout:
                id: one_widget
                orientation: "vertical"
                md_bg_color: "#484848"
                spacing: "10dp"
                padding: "10dp"

                CardViewImage:
                    id: cardImage
                    size_hint: .9, .5
                    pos_hint: {"center_x": .5, "center_y": .5}

            MDBoxLayout:
                id: two_widget
                orientation: "vertical"
                md_bg_color: "#484848"


                MDScrollView:

                    MDGridLayout:
                        id: box_video
                        padding: dp(10)
                        spacing: dp(10)
                        size_hint_y: None
                        height: self.minimum_height
                        cols: 2
                
                MDBoxLayout:
                    id: content_controle
                    orientation: "vertical"
                    md_bg_color: "#484848"
                    size_hint_y: None
                    height: 0
                    opacity: 0

                    CardReducteImage:
                        id: camView



<CardViewImage>:
    md_bg_color: "#676767"
    padding: "10dp"
    spacing: "5dp"
    radius: [24]  # Coins arrondis pour un aspect moderne
    image: image
    lecture: lecture

    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: "#676767"

        MDBoxLayout:
            orientation: "vertical"
            md_bg_color: "#676767"
            size_hint_x: .5
            pos_hint: {'center_x': .5, 'center_y': .7}

            MDBoxLayout:
                orientation: "horizontal"
                md_bg_color: "#676767"
                padding: "10dp"
                spacing: "5dp"
                size_hint_x: .5

                IconButtonAction:
                    id: microphone
                    icon: "microphone-outline"
                    icon_size: dp(20)
                    icon_color: "#4287f5"
                    theme_icon_color: "Custom"
                    on_release: app.listaudio()

                MDLabel:
                    id: audio
                    text: "[color=#4287f5]Audio Cam 1[/color]"
                    font_size: dp(12)
                    size_hint_x: None
                    width: dp(80)
                    halign: "center"
                    markup: True
                    pos_hint: {'center_y': .5}

                IconButtonAction:
                    id: shape
                    icon: "shape-outline"
                    icon_size: dp(20)
                    icon_color: "#4287f5"
                    theme_icon_color: "Custom"
                    on_release: app.listDropdown()

                MDLabel:
                    id: label_format
                    text: "[color=#4287f5]Format[/color]"
                    font_size: dp(10)
                    size_hint_x: None
                    width: dp(80)
                    halign: "center"
                    markup: True
                    pos_hint: {'center_y': .5}

                IconButtonAction:
                    id: save
                    icon: "content-save-outline"
                    icon_size: dp(20)
                    icon_color: "#4287f5"
                    theme_icon_color: "Custom"
                    on_release: app.data.camController.on_record()

            MDCard:
                id: bage_image
                md_bg_color: "#fff000"
                size_hint: None, None
                width: dp(15)
                height: dp(15)
                radius: [24]
                pos_hint: {"center_x": .94, "center_y": .5}
        
        MDSeparator:

        Image:
            id: image
            source: "studio/asset/texture_image.jpg"
            size_hint: None, None
            width: root.width - dp(50)
            height: root.height - dp(75)
            pos_hint: {"center_x": .5, "center_y": .5}

        MDBoxLayout:
            orientation: "horizontal"
            md_bg_color: "#676767"
            spacing: "10dp"
            padding: "10dp"

            IconButtonAction:
                id: microphone
                icon: "microphone-off"
                icon_size: dp(20)
                icon_color: "#4287f5"
                theme_icon_color: "Custom"
                on_release: # Action à définir

            IconButtonAction:
                id: play
                icon: "play"
                icon_size: dp(20)
                icon_color: "#4287f5"
                theme_icon_color: "Custom"
                on_release:
                    asynckivy.start(app.data.camController.on_play()) if self.icon == "play" else app.data.camController.on_break()
                    self.icon = "play" if self.icon == "play" else "pause"

            IconButtonAction:
                id: stop
                icon: "stop"
                icon_size: dp(20)
                icon_color: "#4287f5"
                theme_icon_color: "Custom"
                on_release: app.data.camController.on_stop()

            MDLabel:
                id: lecture
                text: "[color=#ffffff]00:00:00[/color]"
                font_size: dp(12)
                size_hint_x: .3
                pos_hint: {"center_y": .8}
                markup: True
                adaptive_height: True
                halign: 'right'



<CheckItem>
    adaptive_height: True

    MDCheckbox:
        size_hint: None, None
        size: "48dp", "48dp"
        group: root.group

    MDLabel:
        text: root.text
        adaptive_height: True
        theme_text_color: "Custom"
        text_color: "#B2B6AE"
        pos_hint: {"center_y": .5}


<ClickableTextFieldRound>:
    size_hint_y: None
    height: text_field.height
    padding: dp(10)
     
    MDTextField:
        id: text_field
        hint_text: root.hint_text
        icon_left: "magnify"
        font_size: dp(10)
        icon_left_color_normal: "#4287f5"
        icon_left_color_focus: "#4287f5"
        hint_text_color_normal: "#4287f5"
        text_color_normal: "#4287f5"
        line_color_focus: "#4287f5"
        line_color_normal: "#4287f5"
        text: root.text
        # size_hint_x: None
        # width: root.width - dp(5)
        helper_text_mode: "on_focus"    
        on_text: 
            root.text = self.text

    IconButtonAction:
        icon: "magnify"
        icon_size: dp(20)
        style: "tonal"
        theme_bg_color: "Custom"
        icon_color: "#4287f5"
        theme_icon_color: "Custom"
        on_release: asynckivy.start(app.on_start_video())
        pos_hint: {"center_y": .5}
        pos: text_field.width - self.width + dp(5), 0
        theme_text_color: "Hint"



<ClickableTextFieldRoundRedute>:
    size_hint_y: None
    height: text_field.height
    padding: dp(10)
     
    MDTextField:

        id: text_field
        hint_text: root.hint_text
        icon_left: "magnify"
        font_size: dp(10)
        icon_left_color_normal: "#4287f5"
        icon_left_color_focus: "#4287f5"
        hint_text_color_normal: "#4287f5"
        text_color_normal: "#4287f5"
        line_color_focus: "#4287f5"
        line_color_normal: "#4287f5"
        text: root.text
        helper_text_mode: "on_focus"    
        size_hint_x: None
        width: dp(250) 

    IconButtonAction:
        icon: "magnify"
        icon_size: dp(20)
        style: "tonal"
        theme_bg_color: "Custom"
        icon_color: "#4287f5"
        theme_icon_color: "Custom"
        on_release: root.cam_reduct.on_start_video()
        pos_hint: {"center_y": .5}
        pos: text_field.width - self.width + dp(5), 0
        theme_text_color: "Hint"
